(source_file (create_schema_statement schema_name: (identifier)) (create_schema_statement (keyword_if_not_exists) schema_name: (identifier)) (create_function_statement (keyword_replace) routine_name: (identifier) (create_function_parameters (create_function_parameter (identifier) (type)) (create_function_parameter (identifier) (type)) (create_function_parameter (identifier) (type))) (create_function_body (select_subexpression (query_expr (cte_clause (cte alias_name: (identifier) (query_expr (cte_clause (cte alias_name: (identifier) (query_expr (cte_clause (cte alias_name: (identifier) (query_expr (set_operation (query_expr (select (select_list (select_expression (TRUE) (as_alias alias_name: (identifier))) (select_expression (identifier) (as_alias alias_name: (identifier)))) (from_clause (from_item (unnest_clause (unnest_operator (identifier)) (as_alias alias_name: (identifier))))))) (query_expr (select (select_list (select_expression (FALSE) (as_alias alias_name: (identifier))) (select_expression (identifier) (as_alias alias_name: (identifier)))) (from_clause (from_item (unnest_clause (unnest_operator (identifier)) (as_alias alias_name: (identifier))))))))))) (select (select_list (select_expression (identifier)) (select_expression (binary_expression left: (function_call function: (identifier) (analytics_clause (over_clause (window_specification (order_by_clause (order_by_clause_body (identifier))))))) right: (binary_expression left: (binary_expression left: (function_call function: (identifier) argument: (asterisk_expression) (analytics_clause (over_clause (window_specification (window_partition_clause (partition_expression (cast_expression (identifier) (type_identifier)))))))) right: (number)) right: (number))) (as_alias alias_name: (identifier)))) (from_clause (from_item table_name: (identifier))))))) (select (select_list (select_expression (binary_expression left: (function_call function: (identifier) argument: (argument (identifier))) right: (binary_expression left: (binary_expression left: (function_call function: (identifier) argument: (argument (identifier))) right: (binary_expression left: (function_call function: (identifier) argument: (argument (identifier))) right: (number))) right: (number))) (as_alias alias_name: (identifier))) (select_expression (binary_expression left: (binary_expression left: (function_call function: (identifier) argument: (argument (identifier))) right: (binary_expression left: (function_call function: (identifier) argument: (argument (identifier))) right: (binary_expression left: (binary_expression left: (function_call function: (identifier) argument: (argument (identifier))) right: (number)) right: (number)))) right: (function_call function: (identifier) argument: (argument (identifier)))) (as_alias alias_name: (identifier))) (select_expression (binary_expression left: (function_call function: (identifier) argument: (argument (identifier))) right: (function_call function: (identifier) argument: (argument (identifier)))) (as_alias alias_name: (identifier))) (select_expression (function_call function: (identifier) argument: (argument (binary_expression left: (binary_expression left: (binary_expression left: (function_call function: (identifier) argument: (argument (identifier))) right: (function_call function: (identifier) argument: (argument (identifier)))) right: (binary_expression left: (binary_expression left: (function_call function: (identifier) argument: (argument (identifier))) right: (function_call function: (identifier) argument: (argument (identifier)))) right: (number))) right: (number)))) (as_alias alias_name: (identifier)))) (from_clause (from_item table_name: (identifier))) (where_clause (identifier))))) (cte alias_name: (identifier) (query_expr (select (select_list (select_expression (casewhen_expression expr: (identifier) (casewhen_clause match_condition: (string) match_result: (binary_expression left: (binary_expression left: (binary_expression left: (binary_expression left: (identifier) right: (number)) right: (number)) right: (identifier)) right: (identifier))) (casewhen_clause match_condition: (string) match_result: (binary_expression left: (binary_expression left: (binary_expression left: (binary_expression left: (identifier) right: (number)) right: (number)) right: (identifier)) right: (identifier))) (caseelse_clause else_result: (binary_expression left: (binary_expression left: (number) right: (function_call function: (identifier) argument: (argument (binary_expression left: (binary_expression left: (binary_expression left: (identifier) right: (number)) right: (number)) right: (function_call function: (identifier) argument: (argument (binary_expression left: (identifier) right: (identifier))) argument: (argument (identifier)) argument: (argument (identifier))))))) right: (identifier)))) (as_alias alias_name: (identifier))) (select_expression (identifier) (as_alias alias_name: (identifier))) (select_expression (function_call function: (identifier) argument: (argument (binary_expression left: (binary_expression left: (identifier) right: (string)) right: (binary_expression left: (identifier) right: (string)))) argument: (argument (number)) argument: (argument (number))) (as_alias alias_name: (identifier)))) (from_clause (from_item table_name: (identifier))))))) (select (select_list (select_expression (struct (identifier) (ERROR (binary_expression left: (identifier) (ERROR (UNEXPECTED '{')) right: (function_call function: (identifier) argument: (argument (string)))) (UNEXPECTED '}')) (struct (identifier) (number) (number)) (as_alias alias_name: (identifier))))) (from_clause (from_item table_name: (identifier)))))))) (query_statement (query_expr (select (select_list (select_expression (identifier)) (select_expression (identifier)))))) (query_statement (query_expr (select (select_list (select_expression (function_call function: (identifier) argument: (argument (identifier))))) (from_clause (from_item (join_operation (from_item table_name: (identifier)) (join_type) (from_item table_name: (identifier)) (join_condition (binary_expression left: (identifier) right: (identifier)))))) (where_clause (binary_expression left: (identifier) right: (identifier))) (group_by_clause (grouping_item (identifier)) (grouping_item (identifier)))) (order_by_clause (order_by_clause_body (function_call function: (identifier) argument: (argument (identifier))) (identifier))))) (query_statement (query_expr (select (select_list (select_expression (select_subexpression (query_expr (select (select_list (select_expression (number))))))) (select_expression (identifier))) (from_clause (from_item (select_subexpression (query_expr (select (select_list (select_expression (identifier))) (from_clause (from_item table_name: (identifier)))))) (as_alias alias_name: (identifier))))))))